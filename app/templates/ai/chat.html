{% extends 'base.html' %}

{% block title %}AI Chat{% endblock %}

{% block content %}
<div class="container py-4">
    <h2 class="mb-4"><i class="fas fa-comment-medical me-2"></i>AI Health Assistant</h2>
    <form method="post" class="mb-3">
        <div class="input-group">
            <input type="text" name="message" class="form-control" placeholder="Ask a health question..." required>
            <button class="btn btn-primary" type="submit">Send</button>
        </div>
    </form>
    {% if user_message %}
        <div class="alert alert-info">
            <strong>You:</strong> {{ user_message }}
            <div class="text-muted small mt-1">
                <i class="fas fa-clock me-1"></i>
                <span id="user-timestamp"></span>
            </div>
        </div>
    {% endif %}
    {% if ai_response %}
        <div class="alert alert-success">
            <strong>AI:</strong> {{ ai_response }}
            <div class="text-muted small mt-1">
                <i class="fas fa-clock me-1"></i>
                {% if response_time %}{{ response_time }}{% else %}<span id="ai-timestamp"></span>{% endif %}
                {% if model_used %}
                    <i class="fas fa-robot ms-2 me-1"></i>Generated by <strong>{{ model_used }}</strong>
                {% endif %}
            </div>
        </div>
    {% endif %}
</div>

<script>
// Set timestamps for messages
document.addEventListener('DOMContentLoaded', function() {
    const now = new Date();
    const timeString = now.toLocaleDateString('en-US', { 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric',
        hour: 'numeric',
        minute: 'numeric',
        second: 'numeric',
        hour12: true
    });
    
    const userTimestamp = document.getElementById('user-timestamp');
    const aiTimestamp = document.getElementById('ai-timestamp');
    
    if (userTimestamp) {
        userTimestamp.textContent = timeString;
    }
    if (aiTimestamp) {
        aiTimestamp.textContent = timeString;
    }
});
</script>
{% endblock %}
